<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Smart Glasses Face Recognition</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/global.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/face_server.css') }}"
    />
    <script src="{{ url_for('static', filename='js/face_server.js') }}"></script>
  </head>
  <body>
    <div class="toast-container" id="toastContainer"></div>

    <div class="face-header">
      <div class="container">
        <div class="flex items-center justify-between py-4">
          <div>
            <h1 class="face-title">Face Recognition Dashboard</h1>
            <p class="face-subtitle">
              Real-time facial recognition and intelligent visual analytics
            </p>
          </div>
          <div class="text-sm text-muted">
            <span id="currentTime"></span>
          </div>
        </div>
      </div>
    </div>

    <nav class="face-nav">
      <div class="container">
        <div class="face-nav-tabs">
          <button class="face-tab active" onclick="switchTab(event, 'live')">
            Live Recognition
          </button>
          <button class="face-tab" onclick="switchTab(event, 'analytics')">
            Analytics
          </button>
          <button class="face-tab" onclick="switchTab(event, 'reports')">
            Reports
          </button>
          <button class="face-tab" onclick="switchTab(event, 'people')">
            Database
          </button>
        </div>
      </div>
    </nav>

    <main class="face-content">
      <div id="live-tab" class="face-tab-content active">
        <div class="dashboard-grid">
          <div class="camera-section">
            <h3 class="section-title">Camera Feed</h3>
            <img id="cameraFeed" alt="Camera feed will appear here" />
          </div>

          <div class="controls-section">
            <h3 class="section-title">System Controls</h3>
            <button class="button start" onclick="startRecognition()">
              Start Recognition
            </button>
            <button class="button stop" onclick="stopRecognition()">
              Stop Recognition
            </button>
            <button class="button add-person" onclick="openAddPersonModal()">
              Add Person
            </button>

            <h3 class="section-title" style="margin-top: 1.5rem">
              System Status
            </h3>
            <div id="status" class="status">Ready to start</div>

            <h3 class="section-title" style="margin-top: 1.5rem">
              Current Recognition
            </h3>
            <div id="currentResult" class="card p-4">
              <div class="text-muted">No active recognition</div>
            </div>
          </div>
        </div>

        <div class="results-section">
          <h3 class="section-title">Recent Recognition Results</h3>
          <div id="results"></div>
        </div>
      </div>

      <div id="analytics-tab" class="face-tab-content">
        <div class="analytics-grid">
          <div class="stat-card recognition-card">
            <h4>Recognition Rate</h4>
            <div class="stat-value" id="recognitionRate">0%</div>
            <div class="stat-label">Success Rate</div>
          </div>
          <div class="stat-card performance-card">
            <h4>Avg Processing Time</h4>
            <div class="stat-value" id="avgTime">0ms</div>
            <div class="stat-label">Response Time</div>
          </div>
          <div class="stat-card quality-card">
            <h4>Total Requests</h4>
            <div class="stat-value" id="totalRequests">0</div>
            <div class="stat-label">API Calls</div>
          </div>
          <div class="stat-card method-card">
            <h4>Advanced Methods</h4>
            <div class="stat-value" id="enhancedMethods">0</div>
            <div class="stat-label">Advanced Recognition</div>
          </div>
        </div>

        <div class="chart-container">
          <h3 class="section-title">Method Usage Distribution</h3>
          <div id="methodChart" class="card p-4">
            <div class="text-muted">Chart will be displayed here</div>
          </div>
        </div>

        <div class="chart-container">
          <h3 class="section-title">Confidence Level Distribution</h3>
          <div id="confidenceChart" class="card p-4">
            <div class="text-muted">Chart will be displayed here</div>
          </div>
        </div>

        <div class="chart-container">
          <h3 class="section-title">24-Hour Activity Pattern</h3>
          <div id="hourlyChart" class="card p-4">
            <div class="text-muted">Chart will be displayed here</div>
          </div>
        </div>
      </div>

      <div id="reports-tab" class="face-tab-content">
        <div class="report-section">
          <div class="report-header">
            <h2>Daily Analysis Report</h2>
            <div style="display: flex; gap: 15px; align-items: center">
              <input
                type="date"
                id="reportDate"
                class="date-picker"
                onchange="loadDailyReport()"
              />
              <button class="btn btn-primary" onclick="generateTestData()">
                Generate Test Data
              </button>
            </div>
          </div>

          <div id="reportContent" class="card p-4">
            <div class="text-muted">Select a date to view the daily report</div>
          </div>
        </div>

        <div class="report-section">
          <h3 class="section-title">Recognition Logs</h3>
          <div id="recognitionLogs" class="card p-4">
            <div class="text-muted">Recognition logs will appear here</div>
          </div>
        </div>

        <div class="report-section">
          <h3 class="section-title">Historical Performance</h3>
          <div id="historicalData" class="card p-4">
            <div class="text-muted">
              Historical performance data will appear here
            </div>
          </div>
        </div>
      </div>

      <div id="people-tab" class="face-tab-content">
        <div class="report-section">
          <h2 class="section-title">Registered Database</h2>
          <div id="peopleList" class="card p-4">
            <div class="text-muted">
              Registered people database will appear here
            </div>
          </div>
        </div>
      </div>
    </main>
    <div class="modal" id="addPersonModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title">Add New Person</h3>
          <button class="modal-close" onclick="closeAddPersonModal()">
            &times;
          </button>
        </div>
        <div class="modal-body">
          <form id="addPersonForm">
            <div class="form-group">
              <label class="form-label" for="personName">Person Name</label>
              <input
                type="text"
                id="personName"
                class="form-input"
                placeholder="Enter person's name"
                required
              />
            </div>

            <div class="capture-section">
              <h4 style="margin-bottom: 1rem">Capture Images</h4>
              <p style="color: var(--text-secondary); margin-bottom: 1rem">
                Capture 3-5 clear photos from different angles for better
                recognition.
              </p>

              <div class="preview-frame" id="previewFrame">
                <span>Camera preview will appear here</span>
              </div>

              <button
                type="button"
                class="button start"
                onclick="captureImage()"
              >
                Capture Image
              </button>

              <div class="captured-images" id="capturedImages"></div>
            </div>

            <div style="display: flex; gap: 1rem; margin-top: 1.5rem">
              <button
                type="button"
                class="button secondary"
                onclick="closeAddPersonModal()"
              >
                Cancel
              </button>
              <button type="submit" class="button add-person" id="submitBtn">
                Add Person
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </body>
</html>
